function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/menu-BGJ3BcQo.js","assets/vendor-CkiKrRaq.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{u as N,j as e,c as I,a as x,b as D,r as u,d as j,e as v,N as p,f as R,O as z,g as J,A as H,L as E,h as K,i as W,k as G,l as X,R as Q,P as Y,m as Z,n as ee}from"./vendor-CkiKrRaq.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function s(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=s(i);fetch(i.href,l)}})();const se="modulepreload",ae=function(a){return"/pizza-shop/"+a},F={},te=function(t,s,r){let i=Promise.resolve();if(s&&s.length>0){const l=document.getElementsByTagName("link");i=Promise.all(s.map(n=>{if(n=ae(n),n in F)return;F[n]=!0;const d=n.endsWith(".css"),m=d?'[rel="stylesheet"]':"";if(!!r)for(let h=l.length-1;h>=0;h--){const _=l[h];if(_.href===n&&(!d||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${m}`))return;const c=document.createElement("link");if(c.rel=d?"stylesheet":se,d||(c.as="script",c.crossOrigin=""),c.href=n,document.head.appendChild(c),d)return new Promise((h,_)=>{c.addEventListener("load",h),c.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${n}`)))})}))}return i.then(()=>t()).catch(l=>{const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=l,window.dispatchEvent(n),!n.defaultPrevented)throw l})};function L(){const a=N();return e.jsx(e.Fragment,{children:e.jsx("div",{children:e.jsx("button",{className:"btnnavigate",onClick:()=>a(-1),children:e.jsx("img",{className:"btnnavigate__img",src:"/back-02.svg",alt:"BACK"})})})})}function re({children:a,...t}){return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("h1",{className:"upper light",...t,children:a}),e.jsx(L,{})]})})}function M(a){try{const t=localStorage.getItem(a);return t?JSON.parse(t):void 0}catch(t){console.error(t);return}}function A(a,t){const s=JSON.stringify(a);localStorage.setItem(t,s)}const T="cardData",ie=M(T)??{items:[]},B=I({name:"cart",initialState:ie,reducers:{clean:a=>{a.items=[]},delete:(a,t)=>{a.items=a.items.filter(s=>s.id!==t.payload)},remove:(a,t)=>{const s=a.items.find(r=>r.id===t.payload);if(s)if(s.count===1)a.items=a.items.filter(r=>r.id!==t.payload);else{a.items.map(r=>(r.id===t.payload&&(r.count-=1),r));return}},add:(a,t)=>{if(!a.items.find(r=>r.id===t.payload)){a.items.push({id:t.payload,count:1});return}a.items.map(r=>(r.id===t.payload&&(r.count+=1),r))}}}),ne=B.reducer,f=B.actions;function le(a){const{name:t,image:s,price:r,count:i}=a,l=(r/3).toFixed(2),n=x(),d=()=>{n(f.add(a.id))},m=()=>{n(f.remove(a.id))},o=()=>{n(f.delete(a.id))};return e.jsxs("div",{className:"Cart-item",children:[e.jsx("div",{className:"Cart-item__imgbox",children:e.jsx("img",{className:"Cart-item__imgbox__img",src:s,alt:"foto"})}),e.jsxs("div",{className:"Cart-item__text",children:[e.jsxs("h2",{children:[" ",t]}),e.jsxs("h2",{className:"light",children:[l,e.jsx("span",{children:"₴"})]})]}),e.jsxs("div",{className:"Cart-item__boxcount",children:[e.jsxs("div",{className:"Cart-item__count",children:[e.jsx("button",{onClick:m,className:"Cart-item__count__ring",children:"-"}),e.jsx("h3",{className:"light",children:i}),e.jsx("button",{onClick:d,className:"Cart-item__count__ring",children:"+"})]}),e.jsx("div",{className:"Cart-item__delbox",children:e.jsx("button",{onClick:o,className:"Cart-item__delbox__btn",children:"Del"})})]})]})}const b="https://purpleschool.ru/pizza-api-demo";function S({children:a,className:t,appearence:s="small",...r}){return e.jsx("div",{className:"btnbox",children:e.jsx("button",{className:D("btn",t,{small:s==="small",big:s==="big"}),...r,children:a})})}function ce(){const[a,t]=u.useState([]),s=j(o=>o.cart.items),r=N(),i=x(),l=async o=>{const{data:c}=await v.get(`${b}/products/${o}`);return c},n=async()=>{const o=await Promise.all(s.map(c=>l(c.id)));t(o)};u.useEffect(()=>{n()},[s]);const d=()=>{const o=JSON.stringify(s);localStorage.setItem("order",o),i(f.clean()),r("/success")},m=s.map(o=>{const c=a.find(h=>h.id===o.id);return c?o.count*c.price:0}).reduce((o,c)=>o+=c,0)/3;return e.jsxs("div",{className:"rightpanel__cart",children:[e.jsx(re,{children:"Замовлення"}),s.map(o=>{const c=a.find(h=>h.id===o.id);if(c)return e.jsx(le,{count:o.count,...c},c.id)}),e.jsxs("div",{className:"rightpanel__cart__orderbox",children:[e.jsxs("div",{className:"rightpanel__cart__order",children:[e.jsx("h3",{children:"Загальна вартість"}),e.jsxs("h3",{children:[m.toFixed(2)," грн."]})]}),e.jsxs("div",{className:"rightpanel__cart__order",children:[e.jsx("h3",{children:"Доставка"}),e.jsxs("h3",{children:[(m/12).toFixed(2)," грн."]})]}),e.jsxs("div",{className:"rightpanel__cart__order",children:[e.jsxs("h3",{children:["Замовлено ",e.jsx("span",{className:"light fontsize2rem",children:s.length})," шт, на суму ",e.jsx("span",{className:"light fontsize2rem",children:(m+m/12).toFixed(2)})," грн. "]}),e.jsx(S,{onClick:d,appearence:"small",children:"Замовити"})]})]})]})}function oe(){const a=j(t=>t.cart.items).reduce((t,s)=>t+=s.count,0);return e.jsxs("div",{className:"navigator",children:[e.jsxs(p,{to:"/menu",className:"deschidden navigator__item",children:[e.jsx("img",{className:"navigator__item__img",src:"/Left-icon-02.png",alt:""}),"Меню"]}),e.jsxs(p,{to:"/cart",className:"navigator__item",children:[e.jsx("img",{className:"navigator__item__img",src:"/Left-icon-03.png",alt:""}),"Корзина        ",e.jsx("p",{className:"navigator__item__cartitem colorLight",children:a})]}),e.jsxs(p,{to:"/main-menu",className:"mobilhidden navigator__item",children:[e.jsx("img",{className:"navigator__item__img",src:"/Left-icon-02.png",alt:""}),"Меню"]}),e.jsxs(p,{to:"/auth/login",className:"navigator__item",children:[e.jsx("img",{className:"navigator__item__img",src:"/Left-icon-02.png",alt:""}),"Увійти"]}),e.jsxs(p,{to:"/auth/register",className:"navigator__item",children:[e.jsx("img",{className:"navigator__item__img",src:"/Left-icon-02.png",alt:""}),"Pеєстрація"]})]})}const U="userData";var $;const de={jwt:(($=M(U))==null?void 0:$.jwt)??null},P=R("auth/login",async a=>{const{data:t}=await v.post(`${b}/auth/login`,{email:a.email,password:a.password});return t}),C=R("auth/register",async a=>{const{data:t}=await v.post(`${b}/auth/register`,{email:a.email,password:a.password,name:a.name,phone:a.phone,address:a.address});return t}),q=R("user/getProfile",async(a,t)=>{const s=t.getState().user.jwt,{data:r}=await v.get(`${b}/user/profile`,{headers:{Authorization:`Bearer ${s}`}});return r}),V=I({name:"user",initialState:de,reducers:{logout:a=>{a.jwt=null},clearLoginError:a=>{a.loginErrorMass=void 0},clearRegisterError:a=>{a.registerErrorMass=void 0}},extraReducers:a=>{a.addCase(P.fulfilled,(t,s)=>{t.jwt=s.payload.access_token}),a.addCase(P.rejected,(t,s)=>{t.loginErrorMass=s.error.message}),a.addCase(q.fulfilled,(t,s)=>{t.profile=s.payload}),a.addCase(C.fulfilled,(t,s)=>{t.jwt=s.payload.access_token}),a.addCase(C.rejected,(t,s)=>{t.registerErrorMass=s.error.message})}}),me=V.reducer,k=V.actions;function he(){const a=N(),t=x(),s=j(l=>l.user.profile);u.useEffect(()=>{t(q())},[t]);function r(){t(k.logout()),a("/auth/login")}let i="";return(s==null?void 0:s.name)==="Віктор"?i="/user--02.png":(s==null?void 0:s.name)==="Василий"?i="/user--05.png":(s==null?void 0:s.name)==="Victor"?i="/user--02.png":i="/user--01.png",e.jsxs("main",{className:"app",children:[e.jsxs("div",{className:"leftpanel",children:[e.jsx("div",{className:"leftpanel__logo",children:e.jsx("img",{src:"/Logo2-03.svg",alt:""})}),e.jsxs("div",{className:"leftpanel__user",children:[e.jsx("div",{className:"leftpanel__user__foto",children:e.jsx("img",{src:i,alt:"user-foro"})}),e.jsxs("div",{className:"leftpanel__user__text",children:[e.jsx("h2",{className:"",children:s==null?void 0:s.name}),e.jsx("p",{className:"light ",children:s==null?void 0:s.email}),e.jsxs("p",{className:"",children:["ID: ",s==null?void 0:s.id]}),e.jsxs("p",{className:"",children:["Місто: ",s==null?void 0:s.address]}),e.jsxs("p",{className:"light ",children:["Тел: ",s==null?void 0:s.phone]})]})]}),e.jsx(oe,{}),e.jsx("div",{className:"leftpanel__btn",children:e.jsxs(S,{onClick:r,appearence:"small",children:[" ",e.jsx("img",{src:"/close-04.png",alt:"exit"})," Вихід"]})})]}),e.jsx("div",{className:"rightpanel",children:e.jsx(z,{})})]})}function ue(){return e.jsx("div",{className:"rightpanel",children:e.jsx("h2",{className:"light",children:"ERROR. NOT FOUND"})})}function w({error:a}){return e.jsxs("div",{className:"preloaderbox",children:[e.jsx("div",{className:"preloader"}),";",e.jsxs("h3",{className:"preloader__text",children:["Потрібно увімкнути VPN ",e.jsx("br",{}),"Та/Або дочекайтесть відповіді"]}),e.jsx("h1",{className:"preloader__text light",children:a})]})}function ge(){const a=J(),t=x();return e.jsx(e.Fragment,{children:e.jsx(u.Suspense,{fallback:e.jsx(w,{error:"Йде завантаження"}),children:e.jsx(H,{resolve:a.data,children:({data:s})=>e.jsx(e.Fragment,{children:s?e.jsxs("div",{className:"goodscardbig",children:[e.jsxs("div",{className:"goodscardbig__text",children:[e.jsx("h1",{className:"marginbottom2 bold light",children:s.name}),e.jsx("h3",{className:"marginbottom2",children:s.ingredients.join(", ")})]}),e.jsxs("div",{className:"goodscardbig__imgbox",children:[e.jsx("img",{className:"goodscardbig__imgbox__img",src:s.image,alt:"foto"}),e.jsx("div",{className:"goodscardbig__imgbox__price",children:e.jsxs("h2",{className:"dark",children:[(s.price/3).toFixed(2),e.jsx("span",{children:"₴"})]})}),e.jsxs("div",{className:"goodscardbig__imgbox__raiting",children:[e.jsx("p",{className:"dark bold",children:s.rating}),e.jsx("img",{className:"goodscardbig__imgbox__raiting__icon",src:"/star-06.svg",alt:"star"})]}),e.jsx("button",{onClick:r=>{r.preventDefault(),t(f.add(s.id))},className:"goodscardbig__imgbox__cart",children:e.jsx("img",{className:"goodscardbig__imgbox__cart__icon",src:"/Left-icon-03.png",alt:"cart"})})]}),e.jsx("div",{className:"taright",children:e.jsx(L,{})})]}):e.jsx(w,{error:"Помилка! Такої сторінки немає"})})})})})}function _e(){return e.jsxs("div",{className:"authlayout",children:[e.jsxs("div",{className:"authlayout__logo",children:[e.jsx("img",{className:"authlayout__logo__img",src:"/authlogo.svg",alt:""}),e.jsx("div",{className:"navigatebox",children:e.jsx(L,{})})]}),e.jsx("div",{className:"authlayout__box",children:e.jsx(z,{})})]})}const g=u.forwardRef(function({isValid:t=!0,className:s,...r},i){return e.jsx("input",{ref:i,className:D("input",s,{invalid:!t}),...r})});function xe(){const a=N(),t=x(),{jwt:s,loginErrorMass:r}=j(d=>d.user);u.useEffect(()=>{s&&a("/start")},[s,a]);const i=async d=>{d.preventDefault(),t(k.clearLoginError());const m=d.target,{email:o,password:c}=m;await l(o.value,c.value)},l=async(d,m)=>{t(P({email:d,password:m}))};let n="";return r==="Request failed with status code 401"?n="помилка. невірний логін або пароль":r==="Request failed with status code 400"?n="помилка. введіть корpектно e-mail":r==="Network Error"?n="Network Error / УВІМКНІТЬ VPN":n=r,e.jsxs("div",{className:"authlayout__auth",children:[e.jsx("p",{className:"authlayout__auth__header light",children:'Увімкніть VPN, API з домена "ру"'}),e.jsx("h2",{className:"authlayout__auth__header",children:"Вхід"}),r&&e.jsx("h3",{className:"marginbottom2 light upper",children:n}),e.jsxs("form",{onSubmit:i,className:"authlayout__auth__form",children:[e.jsx("label",{className:"authlayout__auth__label",htmlFor:"mail",children:"mail"}),e.jsx(g,{name:"email",id:"mail",placeholder:"mail"}),e.jsx("label",{className:"authlayout__auth__label",htmlFor:"password",children:"password"}),e.jsx(g,{name:"password",type:"password",id:"password",placeholder:"password"}),e.jsx(S,{appearence:"big",children:"Вхід"})]}),e.jsxs("h3",{className:"tacenter",children:["Увійдіть, або ",e.jsx(E,{className:"light",to:"/auth/register",children:"зареєструйтеся"})]})]})}function je(){const a=N(),t=x(),{jwt:s,registerErrorMass:r}=j(n=>n.user);u.useEffect(()=>{s&&a("/start")},[s,a]);const i=async n=>{n.preventDefault(),t(k.clearRegisterError());const d=n.target,{email:m,password:o,name:c,phone:h,address:_}=d;t(C({email:m.value,password:o.value,name:c.value,phone:h.value,address:_.value}))};let l="";return r==="Request failed with status code 401"?l="такий користувач вже зареєстрований":r==="Network Error"?l="Network Error / УВІМКНІТЬ VPN":l=r,e.jsxs("div",{className:"authlayout__auth",children:[r&&e.jsx("h3",{className:"marginbottom2 light upper",children:l}),e.jsx("h2",{className:"authlayout__auth__header",children:"Реєстрація"}),e.jsxs("form",{onSubmit:i,className:"authlayout__auth__form",children:[e.jsx("label",{className:"authlayout__auth__label",htmlFor:"name",children:"Name"}),e.jsx(g,{id:"name",name:"name",placeholder:"Name"}),e.jsx("label",{className:"authlayout__auth__label",htmlFor:"name",children:"Phone"}),e.jsx(g,{id:"phone",name:"phone",placeholder:"Phone"}),e.jsx("label",{className:"authlayout__auth__label",htmlFor:"name",children:"Address"}),e.jsx(g,{id:"address",name:"address",placeholder:"address"}),e.jsx("label",{className:"authlayout__auth__label",htmlFor:"mail",children:"Mail"}),e.jsx(g,{id:"email",name:"email",placeholder:"E-mail"}),e.jsx("label",{className:"authlayout__auth__label",htmlFor:"password",children:"Password"}),e.jsx(g,{id:"password",name:"password",type:"password",placeholder:"Password"}),e.jsx(S,{appearence:"big",children:"Реєструвати"})]}),e.jsx(E,{className:"light upper",to:"/auth/login",children:"Маю аккаунт"})]})}const pe=({children:a})=>j(s=>s.user.jwt)?a:e.jsx(K,{to:"/auth/login",replace:!0});function fe(){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"startpage",children:[e.jsx("h1",{className:"light",children:"Вітаємо!"}),e.jsx("h1",{children:"Ласкаво просимо у наш магазин"}),e.jsx("div",{className:"startpage__imgbox",children:e.jsx("img",{className:"startpage__img",src:"/startimg.svg",alt:""})}),e.jsxs("h1",{className:"tacenter",children:["Зробіть свій вибір у ",e.jsx(E,{className:"light",to:"/menu",children:"меню"})]})]})})}const y=W({reducer:{user:me,cart:ne}});y.subscribe(()=>{A({jwt:y.getState().user.jwt},U),A(y.getState().cart,T)});function Ne(){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"startpage",children:[e.jsx("h1",{className:"light",children:"Вітаємо!"}),e.jsx("h1",{children:"Ви оформили замовлення!"}),e.jsx("div",{className:"startpage__imgbox",children:e.jsx("img",{className:"startpage__img",src:"/success-11.png",alt:""})}),e.jsxs("h1",{className:"tacenter",children:["Замовляйте ",e.jsx(E,{className:"light",to:"/menu",children:"ще"})]})]})})}const O=u.lazy(()=>te(()=>import("./menu-BGJ3BcQo.js"),__vite__mapDeps([0,1]))),ve=G([{path:"/",element:e.jsx(pe,{children:e.jsx(he,{})}),children:[{path:"/start",element:e.jsx(fe,{})},{path:"/success",element:e.jsx(Ne,{})},{path:"/cart",element:e.jsx(ce,{})},{path:"/menu",element:e.jsx(u.Suspense,{fallback:e.jsx(w,{error:"Йде завантаження"}),children:e.jsx(O,{})})},{path:"/product/:id",element:e.jsx(ge,{}),errorElement:e.jsx(w,{error:"Щось не так... Такої сторінки немає"}),loader:async({params:a})=>ee({data:await v.get(`${b}/products/${a.id}`).then(t=>t)})}]},{path:"/main-menu",element:e.jsx(O,{})},{path:"/auth",element:e.jsx(_e,{}),children:[{path:"login",element:e.jsx(xe,{})},{path:"register",element:e.jsx(je,{})}]},{path:"*",element:e.jsx(ue,{})}],{basename:"/pizza-shop"});X.createRoot(document.getElementById("root")).render(e.jsx(Q.StrictMode,{children:e.jsx(Y,{store:y,children:e.jsx(Z,{router:ve})})}));export{re as H,w as P,b as a,f as c};
